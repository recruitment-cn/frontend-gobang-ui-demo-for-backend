var O=Object.defineProperty,g=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var E=(o,r,t)=>r in o?O(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t,v=(o,r)=>{for(var t in r||(r={}))$.call(r,t)&&E(o,t,r[t]);if(C)for(var t of C(r))A.call(r,t)&&E(o,t,r[t]);return o},U=(o,r)=>g(o,j(r));import{j as P,c as I,u as k,a as N,r as x,b as L,Q,d as S,R}from"./vendor.668b5a72.js";const M=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=t(e);fetch(e.href,n)}};M();const b=20;function B(o,r){const t=[];for(let i=0;i<o;i+=1)t.push(i);return t.map(i=>r(i))}const s=P.exports.jsx,d=P.exports.jsxs,F=({})=>s("div",{className:"Board-background",children:B(b-1,o=>s("div",{className:"Board-backgroundRow",children:B(b-1,r=>s("div",{className:"Board-backgroundCell"},r))},o))}),w=I(o=>({baseUrl:"https://safe-inlet-22848.herokuapp.com",update:r=>o(t=>v(v({},t),r))}));function W(){const o=w();return k(["GET_GAMES",o.baseUrl],()=>N.get(`${o.baseUrl}/games`),{retry:!1,refetchOnWindowFocus:!1})}function _(o){const r=w();return k(["GET_GAME",r.baseUrl,o],()=>{if(o!==void 0)return N.get(`${r.baseUrl}/games/${o}`)},{retry:!1,refetchOnWindowFocus:!1})}const q=()=>{var m;const[o,r]=w(u=>[u.baseUrl,u.currentGameId]),{data:t,refetch:i}=_(r),[e,n]=x.exports.useState(t==null?void 0:t.data);x.exports.useEffect(()=>{i()},[o,r]),x.exports.useEffect(()=>{n(t==null?void 0:t.data)},[t]);async function c(u,p){if(e==null?void 0:e.complete)return;n(a=>{var l;return a!==void 0?U(v({},a),{positions:[...(l=a.positions)!=null?l:[],{from:"user",position:{x:u,y:p}}]}):void 0});const f=(await N.post(`${o}/games/${r}/positions`,{x:u,y:p})).data;n(a=>{var l;return a!==void 0?U(v({},a),{complete:f.complete,winner:f.winner,positions:f.aiNextPosition?[...(l=a.positions)!=null?l:[],{from:"AI",position:f.aiNextPosition}]:a.positions}):void 0})}return r?d("div",{children:[d("div",{children:["GameId: ",e==null?void 0:e.gameId,", Complete: ",String((m=e==null?void 0:e.complete)!=null?m:""),", Winner: ",e==null?void 0:e.winner]}),d("div",{style:{position:"relative"},children:[s(F,{}),s("div",{className:"Board-cells",children:B(b,u=>{const p=b-u-1;return s("div",{className:"Board-row",children:B(b,y=>{var l,G;const f=(l=e==null?void 0:e.positions)==null?void 0:l.some(h=>h.from==="user"&&h.position.x===y&&h.position.y===p),a=(G=e==null?void 0:e.positions)==null?void 0:G.some(h=>h.from==="AI"&&h.position.x===y&&h.position.y===p);return s("div",{className:L("Board-cell",{"user-point":f,"ai-point":a,"no-point":!((e==null?void 0:e.complete)||f||a)}),onClick:()=>c(y,p)},y)})},p)})})]})]}):null},T=()=>{var i,e,n;const o=w(),{data:r}=W();async function t(){var m;const c=await N.post(`${o.baseUrl}/games`);o.update({currentGameId:(m=c.data)==null?void 0:m.gameId})}return d("div",{children:[o.baseUrl,d("h2",{children:["Game history (",(e=(i=r==null?void 0:r.data.games)==null?void 0:i.length)!=null?e:0,")"]}),s("ul",{children:(n=r==null?void 0:r.data.games)==null?void 0:n.map(c=>d("li",{children:[s("button",{onClick:()=>o.update({currentGameId:c.id}),children:c.id}),c.complete?"Complete":"In Progress"," (",c.winner,")"]},c.id))}),s("button",{onClick:()=>t(),children:"New game"})]})},H=()=>{const o=w();return d("div",{children:["Base Url: ",s("input",{value:o.baseUrl,onChange:r=>o.update({baseUrl:r.target.value}),style:{width:500}})]})},K=new Q,Z=({})=>d(S,{client:K,children:[s(H,{}),s(T,{}),s(q,{})]});R.render(s(Z,{}),document.getElementById("main"));
