var P=Object.defineProperty,k=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var C=(t,r,o)=>r in t?P(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,m=(t,r)=>{for(var o in r||(r={}))j.call(r,o)&&C(t,o,r[o]);if(G)for(var o of G(r))$.call(r,o)&&C(t,o,r[o]);return t},U=(t,r)=>k(t,O(r));import{j as x,c as g,u as E,a as v,r as w,b as A,Q as L,d as Q,R}from"./vendor.668b5a72.js";const S=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}};S();const b=20;function N(t,r){const o=[];for(let i=0;i<t;i+=1)o.push(i);return o.map(i=>r(i))}const n=x.exports.jsx,d=x.exports.jsxs,M=({})=>n("div",{className:"Board-background",children:N(b-1,t=>n("div",{className:"Board-backgroundRow",children:N(b-1,r=>n("div",{className:"Board-backgroundCell"},r))},t))}),y=g(t=>({baseUrl:"http://localhost:5000",update:r=>t(o=>m(m({},o),r))}));function F(){const t=y();return E(["GET_GAMES",t.baseUrl],()=>v.get(`${t.baseUrl}/games`),{retry:!1,refetchOnWindowFocus:!1})}function W(t){const r=y();return E(["GET_GAME",r.baseUrl,t],()=>{if(t!==void 0)return v.get(`${r.baseUrl}/games/${t}`)},{retry:!1,refetchOnWindowFocus:!1})}const _=()=>{const[t,r]=y(a=>[a.baseUrl,a.currentGameId]),{data:o,refetch:i}=W(r),[e,s]=w.exports.useState(o==null?void 0:o.data);w.exports.useEffect(()=>{i()},[t,r]),w.exports.useEffect(()=>{s(o==null?void 0:o.data)},[o]);async function c(a,p){if(e==null?void 0:e.complete)return;s(l=>{var u;return l!==void 0?U(m({},l),{positions:[...(u=l.positions)!=null?u:[],{from:"user",position:{x:a,y:p}}]}):void 0});const f=(await v.post(`${t}/games/${r}/positions`,{x:a,y:p})).data;s(l=>{var u;return l!==void 0?U(m({},l),{complete:f.complete,winner:f.winner,positions:f.aiNextPosition?[...(u=l.positions)!=null?u:[],{from:"AI",position:f.aiNextPosition}]:l.positions}):void 0})}return r?d("div",{children:[d("div",{children:["GameId: ",e==null?void 0:e.gameId,", Complete: ",e==null?void 0:e.complete,", Winner: ",e==null?void 0:e.winner]}),d("div",{style:{position:"relative"},children:[n(M,{}),n("div",{className:"Board-cells",children:N(b,a=>n("div",{className:"Board-row",children:N(b,p=>{var l,u;const B=(l=e==null?void 0:e.positions)==null?void 0:l.some(h=>h.from==="user"&&h.position.x===a&&h.position.y===p),f=(u=e==null?void 0:e.positions)==null?void 0:u.some(h=>h.from==="AI"&&h.position.x===a&&h.position.y===p);return n("div",{className:A("Board-cell",{"user-point":B,"ai-point":f,"no-point":!((e==null?void 0:e.complete)||B||f)}),onClick:()=>c(a,p)},p)})},a))})]})]}):null},q=()=>{var i,e,s;const t=y(),{data:r}=F();async function o(){var a;const c=await v.post(`${t.baseUrl}/games`);t.update({currentGameId:(a=c.data)==null?void 0:a.gameId})}return d("div",{children:[t.baseUrl,d("h2",{children:["Game history (",(e=(i=r==null?void 0:r.data.games)==null?void 0:i.length)!=null?e:0,")"]}),n("ul",{children:(s=r==null?void 0:r.data.games)==null?void 0:s.map(c=>d("li",{children:[n("button",{onClick:()=>t.update({currentGameId:c.id}),children:c.id}),c.complete?"Complete":"In Progress"," (",c.winner,")"]},c.id))}),n("button",{onClick:()=>o(),children:"New game"})]})},T=()=>{const t=y();return d("div",{children:["Base Url: ",n("input",{value:t.baseUrl,onChange:r=>t.update({baseUrl:r.target.value}),style:{width:500}})]})},H=new L,K=({})=>d(Q,{client:H,children:[n(T,{}),n(q,{}),n(_,{})]});R.render(n(K,{}),document.getElementById("main"));
